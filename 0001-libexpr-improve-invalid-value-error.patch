From b8c54c9eea981aad2493fb2a3a433497e44a1a6b Mon Sep 17 00:00:00 2001
From: ckie <git-525ff67@ckie.dev>
Date: Thu, 30 Dec 2021 20:43:47 +0200
Subject: [PATCH 1/2] libexpr: improve invalid value error

---
 src/libexpr/eval.cc | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/libexpr/eval.cc b/src/libexpr/eval.cc
index a95726f5f..2294d3848 100644
--- a/src/libexpr/eval.cc
+++ b/src/libexpr/eval.cc
@@ -145,7 +145,7 @@ void printValue(std::ostream & str, std::set<const Value *> & active, const Valu
         str << v.fpoint;
         break;
     default:
-        throw Error("invalid value");
+        throw Error("invalid value %1%", showType(v));
     }
 
     active.erase(&v);
@@ -184,7 +184,7 @@ string showType(ValueType type)
         case nFloat: return "a float";
         case nThunk: return "a thunk";
     }
-    abort();
+    throw Error("invalid type id %1%", type);
 }
 
 
-- 
2.34.1

